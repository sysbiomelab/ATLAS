require(DirichletMultinomial)
require(dplyr)
library(parallel)
genusMat = read.table("../results/genusAbund.csv", header=T, row.names=1, dec=".", sep=",")
genusMT
genusMat
genusMatT = round(genusMat*10^9)
genusMatT <- genusMatT[,0:(ncol(genusMatT)-1)]
genusMatT
set.seed(1)
genusFit <- mclapply(1:3, dmn, count=as.matrix(genusMatT), verbose=TRUE)
lplc <- sapply(genusFit, laplace)
plot(lplc, type="b", xlab="Number of Dirichlet Components",ylab="Model Fit")
lplc
genusFit
genusMat
row.names(genusMatT)
col.names(genusMatT)
column.names(genusMatT)
col(genusMatT)
names(genusMatT)
genusMatT
genusFit
genusFit[0]
genusFit[[0]]
genusFit
lplc
best <- genusFit[[which.min(lplc)]]
lplc <- sapply(genusFit, laplace)
lplc
genusFit
laplace
require(parallel)
genusMat
coulmns(genusMat)
columns(genusMat)
colnames(genusMat)
genusMatT
genusMatT.sum()
sum(genusMatT)
sum(genusMatT, axis=1)
sum(genusMatT, axis=0)
sum(genusMatT)
heatmap(genusMatT)
genusMatT
